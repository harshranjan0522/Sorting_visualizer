<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Sorting Visualizer</title>
    <style>
        body {
            background: #121212;
            color: #f1f1f1;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }

        input,
        select,
        button {
            padding: 10px;
            font-size: 16px;
            margin: 5px;
            border-radius: 5px;
            border: none;
        }

        .bar-container {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            height: 300px;
            margin-top: 30px;
            gap: 2px;
        }

        .bar {
            width: 30px;
            position: relative;
            background: #2196f3;
            transition: height 0.5s ease, background 0.2s ease;
        }

        .bar span {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 12px;
        }

        .bar.active {
            background: #ffeb3b;
        }

        .bar.sorted {
            background: #4caf50;
        }

        #algoInfo {
            margin-top: 10px;
            font-size: 14px;
            color: #a1a1a1;
            display: none;
        }

        pre {
            background: #1e1e1e;
            color: #f1f1f1;
            text-align: left;
            margin: 20px auto;
            padding: 15px;
            width: 90%;
            max-width: 700px;
            border-radius: 10px;
            overflow-x: auto;
            display: none;
        }
    </style>
</head>

<body>
    <h2>Sorting Visualizer</h2>
    <input id="arrayInput" placeholder="Enter numbers (e.g. 5,1,3,4)" />
    <button onclick="startSort()">Sort</button>
    <br>
    <select id="algoSelect" onchange="showAlgoInfo()">
        <option value="">-- Select Sorting Algorithm --</option>
        <option value="bubble">Bubble Sort</option>
        <option value="selection">Selection Sort</option>
        <option value="merge">Merge Sort</option>
        <option value="quick">Quick Sort</option>
    </select>
    <div id="algoInfo"></div>
    <pre id="codeSnippet"></pre>
    <div class="bar-container" id="barContainer"></div>
    <div id="stepMessage" style="margin-top: 15px; font-size: 16px; color: #f5f5f5;"></div>
    <script>
        function showMessage(msg) {
            document.getElementById("stepMessage").innerText = msg;
        }

        let array = [];
        const delay = 1500;

        const codeSnippets = {
            bubble: `// Bubble Sort
for i = 0 to n-1
  for j = 0 to n-i-1
    if arr[j] > arr[j+1]
      swap(arr[j], arr[j+1])`,
            selection: `// Selection Sort
for i = 0 to n-1
  minIndex = i
  for j = i+1 to n
    if arr[j] < arr[minIndex]
      minIndex = j
  swap(arr[i], arr[minIndex])`,
            merge: `// Merge Sort
mergeSort(arr[], l, r):
  if l < r:
    m = (l+r)/2
    mergeSort(arr, l, m)
    mergeSort(arr, m+1, r)
    merge(arr, l, m, r)`,
            quick: `// Quick Sort
quickSort(arr[], low, high):
  if low < high:
    pi = partition(arr, low, high)
    quickSort(arr, low, pi-1)
    quickSort(arr, pi+1, high)`
        };

        const algoDescriptions = {
            bubble: {
                def: "Bubble Sort: Repeatedly compares adjacent elements and swaps them if needed.",
                time: "Time: O(n²), Best: O(n), Space: O(1)"
            },
            selection: {
                def: "Selection Sort: Finds the minimum element and places it at the beginning.",
                time: "Time: O(n²), Best: O(n²), Space: O(1)"
            },
            merge: {
                def: "Merge Sort: Divide and conquer algorithm that merges sorted halves.",
                time: "Time: O(n log n), Space: O(n)"
            },
            quick: {
                def: "Quick Sort: Partitions the array around a pivot and sorts subarrays.",
                time: "Time: Avg O(n log n), Worst: O(n²), Space: O(log n)"
            }
        };

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function drawBars(highlight = [], sorted = []) {
            const container = document.getElementById("barContainer");
            container.innerHTML = "";

            const max = Math.max(...array);
            array.forEach((val, i) => {
                const bar = document.createElement("div");
                bar.className = "bar";
                bar.style.height = `${(val / max) * 100}%`;
                if (highlight.includes(i)) bar.classList.add("active");
                if (sorted.includes(i)) bar.classList.add("sorted");
                bar.innerHTML = `<span>${val}</span>`;
                container.appendChild(bar);
            });
        }

        async function bubbleSort() {
            const n = array.length;
            for (let i = 0; i < n - 1; i++) {
                for (let j = 0; j < n - i - 1; j++) {
                    drawBars([j, j + 1]);
                    await sleep(delay);
                    if (array[j] > array[j + 1]) {
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                        drawBars([j, j + 1]);
                        await sleep(delay);
                    }
                }
            }
            drawBars([], array.map((_, i) => i));
        }

        async function selectionSort() {
            const n = array.length;
            for (let i = 0; i < n; i++) {
                let min = i;
                for (let j = i + 1; j < n; j++) {
                    drawBars([min, j]);
                    await sleep(delay);
                    if (array[j] < array[min]) min = j;
                }
                if (min !== i) [array[i], array[min]] = [array[min], array[i]];
                drawBars([i, min]);
                await sleep(delay);
            }
            drawBars([], array.map((_, i) => i));
        }

        async function mergeSort(l = 0, r = array.length - 1) {
            if (l >= r) return;

            showMessage(`Dividing: [${l} ... ${r}]`);
            drawBars(Array.from({ length: r - l + 1 }, (_, i) => i + l));
            await sleep(delay);

            const m = Math.floor((l + r) / 2);
            await mergeSort(l, m);
            await mergeSort(m + 1, r);
            await merge(l, m, r);
        }



        async function merge(l, m, r) {
            showMessage(`Merging: [${l} ... ${r}]`);

            const left = array.slice(l, m + 1);
            const right = array.slice(m + 1, r + 1);
            let i = 0, j = 0, k = l;

            while (i < left.length && j < right.length) {
                drawBars([k]);
                await sleep(delay);
                array[k++] = (left[i] <= right[j]) ? left[i++] : right[j++];
            }

            while (i < left.length) {
                array[k++] = left[i++];
                drawBars([k - 1]);
                await sleep(delay);
            }

            while (j < right.length) {
                array[k++] = right[j++];
                drawBars([k - 1]);
                await sleep(delay);
            }

            drawBars(Array.from({ length: r - l + 1 }, (_, i) => i + l));
            await sleep(delay);
        }



        async function quickSort(low = 0, high = array.length - 1) {
            if (low < high) {
                const pi = await partition(low, high);
                await quickSort(low, pi - 1);
                await quickSort(pi + 1, high);
            }
        }

        async function partition(low, high) {
            let pivot = array[high];
            showMessage(`Pivot selected: ${pivot} at index ${high}`);
            drawBars([high]);
            await sleep(delay);

            let i = low - 1;

            for (let j = low; j < high; j++) {
                drawBars([j, high]);
                await sleep(delay);
                if (array[j] < pivot) {
                    i++;
                    [array[i], array[j]] = [array[j], array[i]];
                    drawBars([i, j]);
                    await sleep(delay);
                }
            }

            [array[i + 1], array[high]] = [array[high], array[i + 1]];
            drawBars([i + 1]);
            await sleep(delay);
            return i + 1;
        }


        async function startSort() {
            const input = document.getElementById("arrayInput").value;
            const algo = document.getElementById("algoSelect").value;

            if (!input || !algo) return alert("Please enter array and select algorithm!");

            array = input.split(',').map(Number);
            drawBars();

            if (algo === "bubble") await bubbleSort();
            else if (algo === "selection") await selectionSort();
            else if (algo === "merge") await mergeSort();
            else if (algo === "quick") await quickSort();
            document.getElementById("stepMessage").innerText = "";

            drawBars([], array.map((_, i) => i));
        }

        function showAlgoInfo() {
            const algo = document.getElementById("algoSelect").value;
            const infoDiv = document.getElementById("algoInfo");
            const codeDiv = document.getElementById("codeSnippet");

            if (!algo) {
                infoDiv.style.display = "none";
                codeDiv.style.display = "none";
                return;
            }

            const { def, time } = algoDescriptions[algo];
            infoDiv.innerHTML = `<strong>${def}</strong><br>${time}`;
            infoDiv.style.display = "block";

            codeDiv.innerText = codeSnippets[algo];
            codeDiv.style.display = "block";
        }
    </script>
</body>

</html>
